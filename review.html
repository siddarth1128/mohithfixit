<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reviews - FixItNow</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1e3c72;
            --secondary: #ff6b6b;
            --accent: #4ecdc4;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --dark: #2d3436;
            --light: #f8f9fa;
            --gray: #6c757d;
            --sidebar-width: 260px;
            --header-height: 70px;
            --border-radius: 12px;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            --shadow-hover: 0 10px 25px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: #f5f7fb;
            color: var(--dark);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background: white;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 100;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
        }

        .sidebar.collapsed {
            width: 80px;
        }

        .sidebar.collapsed .sidebar-logo span,
        .sidebar.collapsed .menu-item span,
        .sidebar.collapsed .user-info {
            display: none;
        }

        .sidebar.collapsed .sidebar-header {
            justify-content: center;
            padding: 25px 10px;
        }

        .sidebar.collapsed .menu-item {
            padding: 14px 25px;
            justify-content: center;
        }

        .sidebar-header {
            padding: 25px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
        }

        .sidebar-logo {
            font-weight: 800;
            font-size: 24px;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
            overflow: hidden;
        }

        .sidebar-logo i {
            color: var(--secondary);
            font-size: 26px;
            flex-shrink: 0;
        }

        .sidebar-menu {
            flex: 1;
            padding: 20px 0;
            overflow-y: auto;
            transition: var(--transition);
        }

        .menu-item {
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #555;
            text-decoration: none;
            transition: var(--transition);
            border-left: 4px solid transparent;
            white-space: nowrap;
            overflow: hidden;
        }

        .menu-item:hover, .menu-item.active {
            background: rgba(30, 60, 114, 0.05);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .menu-item i {
            font-size: 18px;
            width: 24px;
            text-align: center;
            flex-shrink: 0;
        }

        .menu-item.active i {
            color: var(--primary);
        }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
            flex-shrink: 0;
        }

        .user-info {
            white-space: nowrap;
            overflow: hidden;
            transition: var(--transition);
        }

        .user-info h4 {
            font-size: 15px;
            margin-bottom: 3px;
        }

        .user-info p {
            font-size: 12px;
            color: var(--gray);
        }

        /* User Profile Panel */
        .user-profile-panel {
            position: fixed;
            bottom: 90px;
            left: 20px;
            width: 300px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: none;
            overflow: hidden;
        }

        .user-profile-panel.active {
            display: block;
            animation: slideUp 0.3s ease;
        }

        .user-profile-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--primary), #2a5298);
            color: white;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-profile-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 600;
            color: white;
        }

        .user-profile-info h3 {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .user-profile-info p {
            font-size: 13px;
            opacity: 0.9;
        }

        .user-profile-menu {
            padding: 15px 0;
        }

        .profile-menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #555;
            text-decoration: none;
            transition: var(--transition);
            cursor: pointer;
        }

        .profile-menu-item:hover {
            background: rgba(30, 60, 114, 0.05);
            color: var(--primary);
        }

        .profile-menu-item i {
            width: 20px;
            text-align: center;
            font-size: 16px;
        }

        .profile-menu-divider {
            height: 1px;
            background: #f0f0f0;
            margin: 10px 0;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: var(--transition);
        }

        .main-content.expanded {
            margin-left: 80px;
        }

        /* Header Styles */
        .header {
            height: var(--header-height);
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            position: sticky;
            top: 0;
            z-index: 99;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-left h1 {
            font-size: 24px;
            color: var(--primary);
            font-weight: 700;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            padding: 10px 15px 10px 40px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            width: 250px;
            font-size: 14px;
            transition: var(--transition);
        }

        .search-box input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1);
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
        }

        .notification-icon {
            position: relative;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .notification-icon:hover {
            background: #e9ecef;
        }

        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: var(--secondary);
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Search Results Panel */
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            z-index: 100;
            margin-top: 5px;
            display: none;
            max-height: 300px;
            overflow-y: auto;
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .search-result-item:hover {
            background: #f8f9fa;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .search-result-desc {
            font-size: 12px;
            color: #777;
        }

        /* Notifications Panel */
        .notifications-panel {
            position: absolute;
            top: 100%;
            right: 0;
            width: 350px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            z-index: 100;
            margin-top: 5px;
            display: none;
            max-height: 400px;
            overflow-y: auto;
        }

        .notifications-panel.active {
            display: block;
        }

        .notifications-header {
            padding: 15px 20px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notifications-header h3 {
            font-size: 16px;
            color: var(--dark);
        }

        .mark-all-read {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 13px;
            cursor: pointer;
            font-weight: 500;
        }

        .notification-item {
            padding: 15px 20px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            gap: 12px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .notification-item:hover {
            background: #f8f9fa;
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-item.unread {
            background: rgba(30, 60, 114, 0.03);
        }

        .notification-icon-small {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(30, 60, 114, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 14px;
            flex-shrink: 0;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .notification-desc {
            font-size: 13px;
            color: #666;
            margin-bottom: 5px;
            line-height: 1.4;
        }

        .notification-time {
            font-size: 11px;
            color: #999;
        }

        .no-notifications {
            padding: 30px 20px;
            text-align: center;
            color: #777;
        }

        /* Reviews Content */
        .reviews-content {
            padding: 30px;
        }

        /* Page Header */
        .page-header {
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 10px;
            font-weight: 700;
        }

        .page-subtitle {
            color: var(--gray);
            font-size: 16px;
            max-width: 600px;
        }

        /* Export Section */
        .export-section {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 20px;
        }

        .export-btn {
            padding: 10px 20px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            color: var(--dark);
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Stats Cards */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .stat-card.total::before { background: var(--primary); }
        .stat-card.average::before { background: var(--warning); }
        .stat-card.positive::before { background: var(--success); }
        .stat-card.pending::before { background: var(--accent); }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 14px;
        }

        .stat-total { color: var(--primary); }
        .stat-average { color: var(--warning); }
        .stat-positive { color: var(--success); }
        .stat-pending { color: var(--accent); }

        /* Filters */
        .review-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            align-items: flex-end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 5px;
            font-weight: 500;
        }

        .filter-select {
            padding: 10px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            font-size: 14px;
            min-width: 150px;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1);
        }

        /* Reviews List */
        .reviews-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .review-item {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
        }

        .review-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        /* Pending Review */
        .pending-review {
            background: linear-gradient(135deg, #fff8e1, #fff);
            border: 2px dashed var(--warning);
        }

        .pending-badge {
            background: var(--warning);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .review-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .review-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 20px;
            flex-shrink: 0;
        }

        .review-details h4 {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .review-meta {
            display: flex;
            gap: 15px;
            font-size: 13px;
            color: var(--gray);
        }

        .review-rating {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stars {
            color: var(--warning);
        }

        .rating-number {
            font-weight: 600;
            color: var(--dark);
        }

        .review-content {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #555;
        }

        .review-details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .detail-label {
            font-size: 12px;
            color: var(--gray);
            font-weight: 500;
        }

        .detail-value {
            font-size: 14px;
            font-weight: 500;
        }

        .review-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 8px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            background: white;
            color: var(--dark);
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .action-btn.primary {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .action-btn.primary:hover {
            background: #152a52;
        }

        .action-btn.success {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .action-btn.success:hover {
            background: #27ae60;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .empty-icon {
            font-size: 60px;
            color: #e0e0e0;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            color: var(--gray);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .empty-state p {
            color: var(--gray);
            margin-bottom: 20px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .header {
                padding: 0 20px;
            }
            
            .search-box {
                display: none;
            }
            
            .reviews-content {
                padding: 20px;
            }
            
            .review-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .review-details-grid {
                grid-template-columns: 1fr;
            }
            
            .review-actions {
                justify-content: flex-start;
            }
        }

        @media (max-width: 576px) {
            .stats-container {
                grid-template-columns: 1fr 1fr;
            }
            
            .review-filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-select {
                min-width: 100%;
            }
        }

        /* Mobile Menu Toggle */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            color: var(--primary);
            cursor: pointer;
            transition: var(--transition);
        }

        .menu-toggle:hover {
            color: var(--secondary);
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
        }

        /* Sidebar Toggle */
        .sidebar-toggle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            margin-right: 10px;
        }

        .sidebar-toggle:hover {
            background: #e9ecef;
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1100;
        }

        .toast {
            background: white;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 350px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--danger);
        }

        .toast.warning {
            border-left: 4px solid var(--warning);
        }

        .toast.info {
            border-left: 4px solid var(--primary);
        }

        .toast-icon {
            font-size: 20px;
        }

        .toast.success .toast-icon {
            color: var(--success);
        }

        .toast.error .toast-icon {
            color: var(--danger);
        }

        .toast.warning .toast-icon {
            color: var(--warning);
        }

        .toast.info .toast-icon {
            color: var(--primary);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .toast-message {
            font-size: 14px;
            color: var(--gray);
        }

        .toast-close {
            background: none;
            border: none;
            font-size: 16px;
            color: var(--gray);
            cursor: pointer;
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Filter Auto-save Indicator */
        .filter-save-indicator {
            font-size: 12px;
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .filter-save-indicator.show {
            opacity: 1;
        }

        /* Rating Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .rating-modal {
            background: white;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            color: var(--primary);
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--secondary);
        }

        .modal-body {
            padding: 25px;
        }

        .rating-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            font-weight: 500;
            font-size: 14px;
        }

        .form-input {
            padding: 10px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            transition: var(--transition);
        }

        .form-input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1);
        }

        .star-rating {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }

        .star-rating i {
            font-size: 24px;
            color: #e0e0e0;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .star-rating i.active {
            color: var(--warning);
        }

        .form-textarea {
            padding: 12px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            min-height: 120px;
            resize: vertical;
            font-family: 'Poppins', sans-serif;
            transition: var(--transition);
        }

        .form-textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1);
        }

        .rating-categories {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .rating-category {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .category-label {
            font-size: 14px;
            font-weight: 500;
        }

        .category-stars {
            display: flex;
            gap: 3px;
        }

        .category-stars i {
            font-size: 16px;
            color: #e0e0e0;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .category-stars i.active {
            color: var(--warning);
        }

        .submit-review-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: var(--transition);
        }

        .submit-review-btn:hover {
            background: #152a52;
        }

        .submit-review-btn:disabled {
            background: var(--gray);
            cursor: not-allowed;
        }

        .modal-footer {
            padding: 20px 25px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Review Insights */
        .review-insights {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .insight-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .insight-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .rating-distribution {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .rating-bar {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .rating-label {
            width: 80px;
            font-size: 14px;
            color: var(--gray);
        }

        .rating-progress {
            flex: 1;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .rating-fill {
            height: 100%;
            background: var(--warning);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .rating-count {
            width: 30px;
            font-size: 12px;
            color: var(--gray);
            text-align: right;
        }

        .service-ratings {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .service-rating-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .service-rating-item:last-child {
            border-bottom: none;
        }

        .service-name {
            font-size: 14px;
            font-weight: 500;
        }

        .service-rating {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .service-rating-stars {
            color: var(--warning);
            font-size: 12px;
        }

        .service-rating-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
        }

        /* Theme Toggle */
        .theme-toggle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background: #e9ecef;
        }

        /* Animation for stats */
        @keyframes countUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stat-card {
            animation: countUp 0.6s ease forwards;
        }

        .stat-card:nth-child(2) { animation-delay: 0.1s; }
        .stat-card:nth-child(3) { animation-delay: 0.2s; }
        .stat-card:nth-child(4) { animation-delay: 0.3s; }

        /* Animation for user profile panel */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dark Mode Styles */
        body.dark-theme {
            --dark: #f8f9fa;
            --light: #2d3436;
            background: #1a1d23;
            color: #f8f9fa;
        }
        
        body.dark-theme .sidebar,
        body.dark-theme .header,
        body.dark-theme .stat-card,
        body.dark-theme .review-item,
        body.dark-theme .empty-state,
        body.dark-theme .rating-modal,
        body.dark-theme .insight-card,
        body.dark-theme .toast,
        body.dark-theme .user-profile-panel,
        body.dark-theme .notifications-panel,
        body.dark-theme .search-results {
            background: #2d3436;
            color: #f8f9fa;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        body.dark-theme .menu-item,
        body.dark-theme .profile-menu-item {
            color: #ddd;
        }
        
        body.dark-theme .menu-item:hover,
        body.dark-theme .menu-item.active,
        body.dark-theme .profile-menu-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #f8f9fa;
        }
        
        body.dark-theme .search-box input,
        body.dark-theme .notification-icon,
        body.dark-theme .theme-toggle,
        body.dark-theme .sidebar-toggle,
        body.dark-theme .filter-select,
        body.dark-theme .export-btn,
        body.dark-theme .action-btn,
        body.dark-theme .form-input,
        body.dark-theme .form-textarea {
            background: #3a4047;
            color: #f8f9fa;
            border-color: #444;
        }
        
        body.dark-theme .search-box input:focus,
        body.dark-theme .filter-select:focus,
        body.dark-theme .form-input:focus,
        body.dark-theme .form-textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.3);
        }
        
        body.dark-theme .review-icon,
        body.dark-theme .action-icon {
            background: #3a4047;
        }
        
        body.dark-theme .review-item,
        body.dark-theme .notification-item,
        body.dark-theme .search-result-item,
        body.dark-theme .service-rating-item {
            border-color: #444;
        }
        
        body.dark-theme .review-item:hover,
        body.dark-theme .notification-item:hover,
        body.dark-theme .search-result-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        body.dark-theme .action-btn.primary {
            background: var(--primary);
            color: white;
        }
        
        body.dark-theme .action-btn.success {
            background: var(--success);
            color: white;
        }
        
        body.dark-theme .action-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        body.dark-theme .export-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        body.dark-theme .filter-label,
        body.dark-theme .detail-label,
        body.dark-theme .category-label,
        body.dark-theme .insight-title,
        body.dark-theme .page-subtitle,
        body.dark-theme .review-meta,
        body.dark-theme .empty-state p,
        body.dark-theme .empty-state h3,
        body.dark-theme .stat-label,
        body.dark-theme .toast-message,
        body.dark-theme .form-label,
        body.dark-theme .rating-label,
        body.dark-theme .rating-count,
        body.dark-theme .service-name {
            color: #aaa;
        }
        
        body.dark-theme .pending-review {
            background: linear-gradient(135deg, #3a3a2a, #2d3436);
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- User Profile Panel -->
    <div class="user-profile-panel" id="userProfilePanel">
        <div class="user-profile-header">
            <div class="user-profile-avatar" id="profileAvatar">JS</div>
            <div class="user-profile-info">
                <h3 id="profileName">John Smith</h3>
                <p id="profileType">Premium Member</p>
            </div>
        </div>
        <div class="user-profile-menu">
            <a href="profile.html" class="profile-menu-item">
                <i class="fas fa-user"></i>
                My Profile
            </a>
            <a href="setting.html" class="profile-menu-item">
                <i class="fas fa-cog"></i>
                Account Settings
            </a>
            <a href="payment.html" class="profile-menu-item">
                <i class="fas fa-credit-card"></i>
                Payment Methods
            </a>
            <div class="profile-menu-divider"></div>
            <a href="#" class="profile-menu-item" id="switchAccountBtn">
                <i class="fas fa-sync-alt"></i>
                Switch Account
            </a>
            <a href="#" class="profile-menu-item" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                Logout
            </a>
        </div>
    </div>

    <!-- Rating Modal -->
    <div class="modal-overlay" id="ratingModal">
        <div class="rating-modal">
            <div class="modal-header">
                <h3 class="modal-title">Rate Service</h3>
                <button class="modal-close" id="closeRatingModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="rating-form" id="ratingForm">
                    <div class="form-group">
                        <label class="form-label">Service</label>
                        <input type="text" class="form-input" id="serviceTitle" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Provider</label>
                        <input type="text" class="form-input" id="providerName" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Overall Rating</label>
                        <div class="star-rating" id="overallRating">
                            <i class="far fa-star" data-rating="1"></i>
                            <i class="far fa-star" data-rating="2"></i>
                            <i class="far fa-star" data-rating="3"></i>
                            <i class="far fa-star" data-rating="4"></i>
                            <i class="far fa-star" data-rating="5"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Review Comment</label>
                        <textarea class="form-textarea" id="reviewComment" placeholder="Share your experience with this service..."></textarea>
                    </div>
                    <div class="rating-categories">
                        <div class="rating-category">
                            <span class="category-label">Service Quality</span>
                            <div class="category-stars" data-category="quality">
                                <i class="far fa-star" data-rating="1"></i>
                                <i class="far fa-star" data-rating="2"></i>
                                <i class="far fa-star" data-rating="3"></i>
                                <i class="far fa-star" data-rating="4"></i>
                                <i class="far fa-star" data-rating="5"></i>
                            </div>
                        </div>
                        <div class="rating-category">
                            <span class="category-label">Professionalism</span>
                            <div class="category-stars" data-category="professionalism">
                                <i class="far fa-star" data-rating="1"></i>
                                <i class="far fa-star" data-rating="2"></i>
                                <i class="far fa-star" data-rating="3"></i>
                                <i class="far fa-star" data-rating="4"></i>
                                <i class="far fa-star" data-rating="5"></i>
                            </div>
                        </div>
                        <div class="rating-category">
                            <span class="category-label">Timeliness</span>
                            <div class="category-stars" data-category="timeliness">
                                <i class="far fa-star" data-rating="1"></i>
                                <i class="far fa-star" data-rating="2"></i>
                                <i class="far fa-star" data-rating="3"></i>
                                <i class="far fa-star" data-rating="4"></i>
                                <i class="far fa-star" data-rating="5"></i>
                            </div>
                        </div>
                        <div class="rating-category">
                            <span class="category-label">Value for Money</span>
                            <div class="category-stars" data-category="value">
                                <i class="far fa-star" data-rating="1"></i>
                                <i class="far fa-star" data-rating="2"></i>
                                <i class="far fa-star" data-rating="3"></i>
                                <i class="far fa-star" data-rating="4"></i>
                                <i class="far fa-star" data-rating="5"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-btn" id="cancelRatingBtn">Cancel</button>
                <button class="action-btn primary" id="submitReviewBtn">
                    <i class="fas fa-star"></i> Submit Review
                </button>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="dashboard.html" class="sidebar-logo">
                <i class="fas fa-tools" aria-hidden="true"></i>
                <span>FixItNow</span>
            </a>
        </div>
        
        <div class="sidebar-menu">
            <a href="dashboard.html" class="menu-item">
                <i class="fas fa-home" aria-hidden="true"></i>
                <span>Dashboard</span>
            </a>
            <a href="book_service.html" class="menu-item">
                <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                <span>Book Services</span>
            </a>
            <a href="service_history.html" class="menu-item">
                <i class="fas fa-history" aria-hidden="true"></i>
                <span>Service History</span>
            </a>
            <a href="invoice.html" class="menu-item">
                <i class="fas fa-file-invoice-dollar" aria-hidden="true"></i>
                <span>Invoices</span>
            </a>
            <a href="#" class="menu-item active">
                <i class="fas fa-star" aria-hidden="true"></i>
                <span>Reviews</span>
            </a>
            <a href="profile.html" class="menu-item">
                <i class="fas fa-user-circle" aria-hidden="true"></i>
                <span>Profile</span>
            </a>
            <a href="setting.html" class="menu-item">
                <i class="fas fa-cog" aria-hidden="true"></i>
                <span>Settings</span>
            </a>
            <a href="help.html" class="menu-item">
                <i class="fas fa-question-circle" aria-hidden="true"></i>
                <span>Help & Support</span>
            </a>
        </div>
        
        <div class="sidebar-footer" id="userProfileSection">
            <div class="user-profile">
                <div class="user-avatar" id="userAvatar">JS</div>
                <div class="user-info">
                    <h4 id="userName">John Smith</h4>
                    <p id="userType">Premium Member</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <button class="menu-toggle" type="button" aria-label="Toggle navigation menu">
                    <i class="fas fa-bars" aria-hidden="true"></i>
                </button>
                <h1>Reviews</h1>
            </div>
            
            <div class="header-right">
                <div class="search-box">
                    <i class="fas fa-search" aria-hidden="true"></i>
                    <input type="text" placeholder="Search reviews..." aria-label="Search reviews" id="searchInput">
                    <div class="search-results" id="searchResults">
                        <!-- Search results will be populated here -->
                    </div>
                </div>
                
                <div class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </div>
                
                <div class="notification-icon" id="notificationIcon">
                    <i class="fas fa-bell" aria-hidden="true"></i>
                    <span class="notification-badge" id="notificationBadge">3</span>
                    <div class="notifications-panel" id="notificationsPanel">
                        <div class="notifications-header">
                            <h3>Notifications</h3>
                            <button class="mark-all-read" id="markAllRead">Mark all as read</button>
                        </div>
                        <div id="notificationsList">
                            <!-- Notifications will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Reviews Content -->
        <div class="reviews-content">
            <!-- Page Header -->
            <div class="page-header">
                <h1 class="page-title">Reviews & Ratings</h1>
                <p class="page-subtitle">View your service reviews, rate completed services, and manage your feedback.</p>
            </div>
            
            <!-- Export Section -->
            <div class="export-section">
                <button class="export-btn" id="exportBtn">
                    <i class="fas fa-download"></i> Export Reviews
                </button>
            </div>
            
            <!-- Review Insights -->
            <div class="review-insights">
                <div class="insight-card">
                    <h4 class="insight-title">Rating Distribution</h4>
                    <div class="rating-distribution" id="ratingDistribution">
                        <!-- Rating distribution will be populated by JavaScript -->
                    </div>
                </div>
                <div class="insight-card">
                    <h4 class="insight-title">Service Ratings</h4>
                    <div class="service-ratings" id="serviceRatings">
                        <!-- Service ratings will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <!-- Stats Cards -->
            <div class="stats-container">
                <div class="stat-card total" data-filter="all">
                    <div class="stat-number stat-total" id="totalReviews">15</div>
                    <div class="stat-label">Total Reviews</div>
                </div>
                
                <div class="stat-card average" data-filter="average">
                    <div class="stat-number stat-average" id="averageRating">4.8</div>
                    <div class="stat-label">Average Rating</div>
                </div>
                
                <div class="stat-card positive" data-filter="positive">
                    <div class="stat-number stat-positive" id="positiveReviews">12</div>
                    <div class="stat-label">Positive Reviews</div>
                </div>
                
                <div class="stat-card pending" data-filter="pending">
                    <div class="stat-number stat-pending" id="pendingReviews">2</div>
                    <div class="stat-label">Pending Reviews</div>
                </div>
            </div>
            
            <!-- Filters -->
            <div class="review-filters">
                <div class="filter-group">
                    <span class="filter-label">Rating</span>
                    <select class="filter-select" id="ratingFilter">
                        <option value="all">All Ratings</option>
                        <option value="5">5 Stars</option>
                        <option value="4">4 Stars</option>
                        <option value="3">3 Stars</option>
                        <option value="2">2 Stars</option>
                        <option value="1">1 Star</option>
                    </select>
                    <div class="filter-save-indicator" id="rating-save-indicator">
                        <i class="fas fa-check"></i> Saved
                    </div>
                </div>
                
                <div class="filter-group">
                    <span class="filter-label">Service Type</span>
                    <select class="filter-select" id="serviceTypeFilter">
                        <option value="all">All Services</option>
                        <option value="plumbing">Plumbing</option>
                        <option value="electrical">Electrical</option>
                        <option value="painting">Painting</option>
                        <option value="ac">AC Repair</option>
                        <option value="cleaning">Cleaning</option>
                        <option value="carpentry">Carpentry</option>
                    </select>
                    <div class="filter-save-indicator" id="service-save-indicator">
                        <i class="fas fa-check"></i> Saved
                    </div>
                </div>
                
                <div class="filter-group">
                    <span class="filter-label">Status</span>
                    <select class="filter-select" id="statusFilter">
                        <option value="all">All Statuses</option>
                        <option value="completed">Completed</option>
                        <option value="pending">Pending</option>
                    </select>
                    <div class="filter-save-indicator" id="status-save-indicator">
                        <i class="fas fa-check"></i> Saved
                    </div>
                </div>
                
                <div class="filter-group">
                    <span class="filter-label">&nbsp;</span>
                    <button class="action-btn primary" id="resetFilters">
                        <i class="fas fa-redo"></i> Reset Filters
                    </button>
                </div>
            </div>
            
            <!-- Reviews List -->
            <div class="reviews-list" id="reviewsList">
                <!-- Review items will be dynamically loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Reviews Application
        class ReviewsApp {
            constructor() {
                this.reviewData = [];
                this.filteredReviews = [];
                this.currentUser = {
                    id: 1,
                    name: "John Smith",
                    initials: "JS",
                    type: "Premium Member",
                    email: "john.smith@example.com",
                    phone: "+1 (555) 123-4567",
                    joinDate: "January 2023"
                };
                this.init();
            }
            
            init() {
                this.loadReviewData();
                this.setupEventListeners();
                this.loadFilterPreferences();
                this.updateInsights();
                this.renderReviewItems();
                this.initializeDashboard();
                this.initializeProfilePanel();
                this.initializeSidebarToggle();
                this.initializeThemeToggle();
                this.initializeToast();
                this.updateNotifications();
            }
            
            // Load review data
            loadReviewData() {
                this.reviewData = [
                    {
                        id: 1,
                        title: "Kitchen Sink Repair",
                        date: "2023-10-15",
                        provider: "Mike Plumbing Pros",
                        status: "completed",
                        serviceType: "plumbing",
                        rating: 5,
                        comment: "Excellent service! Mike arrived on time and fixed our kitchen sink leak quickly and professionally. Very friendly and cleaned up after the job. Highly recommended!",
                        categories: {
                            quality: "Excellent",
                            professionalism: "Outstanding",
                            timeliness: "On Time",
                            value: "Great Value"
                        },
                        editable: true
                    },
                    {
                        id: 2,
                        title: "Electrical Wiring",
                        date: "2023-10-18",
                        provider: "Electro Masters",
                        status: "completed",
                        serviceType: "electrical",
                        rating: 4,
                        comment: "Good electrical work completed as requested. The technician was knowledgeable and professional. Only minor issue was running about 15 minutes late, but communicated well about the delay.",
                        categories: {
                            quality: "Very Good",
                            professionalism: "Professional",
                            timeliness: "Slightly Late",
                            value: "Fair Price"
                        },
                        editable: true
                    },
                    {
                        id: 3,
                        title: "Living Room Painting",
                        date: "2023-10-22",
                        provider: "Color Masters",
                        status: "pending",
                        serviceType: "painting",
                        rating: 0,
                        comment: "",
                        categories: {},
                        editable: false
                    },
                    {
                        id: 4,
                        title: "AC Maintenance",
                        date: "2023-10-10",
                        provider: "Cool Air Pros",
                        status: "completed",
                        serviceType: "ac",
                        rating: 5,
                        comment: "Outstanding AC maintenance service! The technician was extremely thorough, explained everything clearly, and even provided tips for maintaining our AC unit. The system is running much more efficiently now. Will definitely use again!",
                        categories: {
                            quality: "Excellent",
                            professionalism: "Outstanding",
                            timeliness: "Early",
                            value: "Excellent Value"
                        },
                        editable: true
                    },
                    {
                        id: 5,
                        title: "Bathroom Leak Fix",
                        date: "2023-09-28",
                        provider: "Aqua Plumbing Solutions",
                        status: "completed",
                        serviceType: "plumbing",
                        rating: 5,
                        comment: "Quick response and excellent service. Fixed our bathroom leak in no time and was very courteous throughout the process.",
                        categories: {
                            quality: "Excellent",
                            professionalism: "Professional",
                            timeliness: "On Time",
                            value: "Great Value"
                        },
                        editable: true
                    },
                    {
                        id: 6,
                        title: "Deep Cleaning",
                        date: "2023-11-05",
                        provider: "Sparkle Cleaners",
                        status: "pending",
                        serviceType: "cleaning",
                        rating: 0,
                        comment: "",
                        categories: {},
                        editable: false
                    },
                    {
                        id: 7,
                        title: "Cabinet Installation",
                        date: "2023-08-15",
                        provider: "Woodcraft Masters",
                        status: "completed",
                        serviceType: "carpentry",
                        rating: 4,
                        comment: "Good quality cabinet installation. The carpenter was skilled and the cabinets look great. Took a bit longer than estimated but the result was worth it.",
                        categories: {
                            quality: "Very Good",
                            professionalism: "Professional",
                            timeliness: "Slightly Late",
                            value: "Good Value"
                        },
                        editable: true
                    }
                ];
                
                this.filteredReviews = [...this.reviewData];
            }
            
            // Initialize the dashboard with current user data
            initializeDashboard() {
                // Update user information
                document.getElementById('userAvatar').textContent = this.currentUser.initials;
                document.getElementById('userName').textContent = this.currentUser.name;
                document.getElementById('userType').textContent = this.currentUser.type;
                
                document.getElementById('profileAvatar').textContent = this.currentUser.initials;
                document.getElementById('profileName').textContent = this.currentUser.name;
                document.getElementById('profileType').textContent = this.currentUser.type;
            }

            // User profile panel functionality
            initializeProfilePanel() {
                const userProfileSection = document.getElementById('userProfileSection');
                const userProfilePanel = document.getElementById('userProfilePanel');
                const switchAccountBtn = document.getElementById('switchAccountBtn');
                const logoutBtn = document.getElementById('logoutBtn');
                
                if (userProfileSection && userProfilePanel) {
                    userProfileSection.addEventListener('click', function(e) {
                        e.stopPropagation();
                        userProfilePanel.classList.toggle('active');
                    });
                    
                    // Close profile panel when clicking outside
                    document.addEventListener('click', function(e) {
                        if (!e.target.closest('.sidebar-footer') && !e.target.closest('.user-profile-panel')) {
                            userProfilePanel.classList.remove('active');
                        }
                    });
                    
                    // Switch account functionality
                    switchAccountBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        // In a real app, this would show a login modal or redirect to login
                        // For demo purposes, we'll show a message
                        this.showToast('Account switching feature would be implemented here', 'info');
                        userProfilePanel.classList.remove('active');
                    }.bind(this));
                    
                    // Logout functionality
                    logoutBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        // In a real app, this would clear session and redirect to login
                        if (confirm('Are you sure you want to logout?')) {
                            this.showToast('You have been logged out successfully', 'success');
                            // Redirect to login page in a real app
                            // window.location.href = 'login.html';
                        }
                    }.bind(this));
                }
            }

            // Sidebar toggle functionality
            initializeSidebarToggle() {
                const sidebarToggle = document.getElementById('sidebarToggle');
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.getElementById('mainContent');
                
                if (sidebarToggle && sidebar && mainContent) {
                    sidebarToggle.addEventListener('click', function() {
                        sidebar.classList.toggle('collapsed');
                        mainContent.classList.toggle('expanded');
                        
                        // Change icon based on state
                        const icon = this.querySelector('i');
                        if (sidebar.classList.contains('collapsed')) {
                            icon.className = 'fas fa-chevron-right';
                        } else {
                            icon.className = 'fas fa-bars';
                        }
                    });
                }
            }

            // Theme toggle functionality
            initializeThemeToggle() {
                const themeToggle = document.getElementById('themeToggle');
                const icon = themeToggle.querySelector('i');
                
                // Check for saved theme preference or default to light
                const currentTheme = localStorage.getItem('theme') || 'light';
                if (currentTheme === 'dark') {
                    document.body.classList.add('dark-theme');
                    icon.className = 'fas fa-sun';
                }
                
                themeToggle.addEventListener('click', function() {
                    document.body.classList.toggle('dark-theme');
                    
                    if (document.body.classList.contains('dark-theme')) {
                        localStorage.setItem('theme', 'dark');
                        icon.className = 'fas fa-sun';
                        this.showToast('Dark mode enabled', 'success');
                    } else {
                        localStorage.setItem('theme', 'light');
                        icon.className = 'fas fa-moon';
                        this.showToast('Light mode enabled', 'success');
                    }
                }.bind(this));
            }

            // Toast notification functionality
            initializeToast() {
                const toastContainer = document.getElementById('toastContainer');
                
                // Auto-hide toast after 5 seconds
                toastContainer.addEventListener('animationend', function(e) {
                    if (e.target.classList.contains('show')) {
                        setTimeout(() => {
                            if (e.target.parentNode) {
                                e.target.classList.remove('show');
                                setTimeout(() => {
                                    if (e.target.parentNode) {
                                        e.target.parentNode.removeChild(e.target);
                                    }
                                }, 300);
                            }
                        }, 5000);
                    }
                });
            }
            
            // Setup event listeners
            setupEventListeners() {
                // Mobile menu toggle
                document.querySelector('.menu-toggle').addEventListener('click', () => {
                    document.querySelector('.sidebar').classList.toggle('active');
                });
                
                // Filter event listeners
                document.getElementById('ratingFilter').addEventListener('change', () => {
                    this.showAutoSaveIndicator('rating');
                    this.saveFilterPreferences();
                    this.filterReviews();
                });
                
                document.getElementById('serviceTypeFilter').addEventListener('change', () => {
                    this.showAutoSaveIndicator('service');
                    this.saveFilterPreferences();
                    this.filterReviews();
                });
                
                document.getElementById('statusFilter').addEventListener('change', () => {
                    this.showAutoSaveIndicator('status');
                    this.saveFilterPreferences();
                    this.filterReviews();
                });
                
                document.getElementById('searchInput').addEventListener('input', () => {
                    this.saveFilterPreferences();
                    this.filterReviews();
                });
                
                document.getElementById('resetFilters').addEventListener('click', () => {
                    this.resetFilters();
                });
                
                document.getElementById('exportBtn').addEventListener('click', () => {
                    this.exportReviews();
                });
                
                // Modal event listeners
                document.getElementById('closeRatingModal').addEventListener('click', () => {
                    this.closeRatingModal();
                });
                
                document.getElementById('cancelRatingBtn').addEventListener('click', () => {
                    this.closeRatingModal();
                });
                
                document.getElementById('submitReviewBtn').addEventListener('click', () => {
                    this.submitReview();
                });
                
                // Close modal when clicking outside
                document.getElementById('ratingModal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('ratingModal')) {
                        this.closeRatingModal();
                    }
                });
                
                // Close modal with Escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeRatingModal();
                    }
                });
                
                // Star rating interactions
                this.setupStarRatingInteractions();
                
                // Notification click
                const notificationIcon = document.getElementById('notificationIcon');
                if (notificationIcon) {
                    notificationIcon.addEventListener('click', (e) => {
                        e.stopPropagation();
                        document.getElementById('notificationsPanel').classList.toggle('active');
                    });
                    
                    // Add keyboard support for notification icon
                    notificationIcon.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            document.getElementById('notificationsPanel').classList.toggle('active');
                        }
                    });
                }
                
                // Mark all as read
                document.getElementById('markAllRead').addEventListener('click', () => {
                    this.showToast('All notifications marked as read', 'success');
                    document.getElementById('notificationsPanel').classList.remove('active');
                });
                
                // Close notifications when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.notification-icon') && !e.target.closest('.notifications-panel')) {
                        document.getElementById('notificationsPanel').classList.remove('active');
                    }
                });
                
                // Search functionality
                const searchInput = document.getElementById('searchInput');
                const searchResults = document.getElementById('searchResults');
                
                if (searchInput && searchResults) {
                    searchInput.addEventListener('focus', () => {
                        if (this.searchInput.value.trim() !== '') {
                            this.performSearch(this.searchInput.value);
                        }
                    });
                    
                    searchInput.addEventListener('input', () => {
                        this.performSearch(searchInput.value);
                    });
                }
                
                // Close search results when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.search-box')) {
                        if (searchResults) searchResults.classList.remove('active');
                    }
                });
                
                // Stats cards click to filter
                document.querySelectorAll('.stat-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const filter = card.dataset.filter;
                        if (filter && filter !== 'all') {
                            if (filter === 'positive') {
                                document.getElementById('ratingFilter').value = '4';
                                this.saveFilterPreferences();
                                this.filterReviews();
                                this.showToast(`Filtered by positive reviews (4+ stars)`, 'info');
                            } else if (filter === 'pending') {
                                document.getElementById('statusFilter').value = 'pending';
                                this.saveFilterPreferences();
                                this.filterReviews();
                                this.showToast(`Filtered by pending reviews`, 'info');
                            } else if (filter === 'average') {
                                // For average, we'll just show a message
                                this.showToast(`Average rating is calculated from all your reviews`, 'info');
                            } else {
                                document.getElementById('statusFilter').value = filter;
                                this.saveFilterPreferences();
                                this.filterReviews();
                                this.showToast(`Filtered by ${filter} reviews`, 'info');
                            }
                        } else if (filter === 'all') {
                            this.resetFilters();
                        }
                    });
                });
            }
            
            // Setup star rating interactions
            setupStarRatingInteractions() {
                // Overall rating stars
                document.querySelectorAll('#overallRating i').forEach(star => {
                    star.addEventListener('click', () => {
                        const rating = parseInt(star.dataset.rating);
                        this.setStarRating('overallRating', rating);
                    });
                    
                    star.addEventListener('mouseover', () => {
                        const rating = parseInt(star.dataset.rating);
                        const container = star.parentElement;
                        const stars = container.querySelectorAll('i');
                        
                        stars.forEach((s, index) => {
                            if (index < rating) {
                                s.className = 'fas fa-star active';
                            } else {
                                s.className = 'far fa-star';
                            }
                        });
                    });
                    
                    star.addEventListener('mouseout', () => {
                        const container = star.parentElement;
                        const currentRating = parseInt(container.dataset.rating) || 0;
                        this.setStarRating('overallRating', currentRating);
                    });
                });
                
                // Category star interactions
                document.querySelectorAll('.category-stars i').forEach(star => {
                    star.addEventListener('click', () => {
                        const rating = parseInt(star.dataset.rating);
                        const container = star.parentElement;
                        const category = container.dataset.category;
                        this.setCategoryRating(category, rating);
                    });
                    
                    star.addEventListener('mouseover', () => {
                        const rating = parseInt(star.dataset.rating);
                        const container = star.parentElement;
                        const stars = container.querySelectorAll('i');
                        
                        stars.forEach((s, index) => {
                            if (index < rating) {
                                s.className = 'fas fa-star active';
                            } else {
                                s.className = 'far fa-star';
                            }
                        });
                    });
                    
                    star.addEventListener('mouseout', () => {
                        const container = star.parentElement;
                        const currentRating = parseInt(container.dataset.rating) || 0;
                        this.setCategoryRating(container.dataset.category, currentRating);
                    });
                });
            }
            
            // Show auto-save indicator
            showAutoSaveIndicator(field) {
                const indicator = document.getElementById(`${field}-save-indicator`);
                indicator.classList.add('show');
                
                setTimeout(() => {
                    indicator.classList.remove('show');
                }, 2000);
            }
            
            // Format date for display
            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric', 
                    year: 'numeric' 
                });
            }
            
            // Generate star rating HTML
            generateStars(rating) {
                let stars = '';
                for (let i = 1; i <= 5; i++) {
                    if (i <= rating) {
                        stars += '<i class="fas fa-star"></i>';
                    } else {
                        stars += '<i class="far fa-star"></i>';
                    }
                }
                return stars;
            }
            
            // Get service icon based on service type
            getServiceIcon(serviceType) {
                const icons = {
                    plumbing: 'faucet',
                    electrical: 'bolt',
                    painting: 'paint-roller',
                    ac: 'wind',
                    cleaning: 'soap',
                    carpentry: 'tools'
                };
                return icons[serviceType] || 'tools';
            }
            
            // Render review items
            renderReviewItems() {
                const reviewsList = document.getElementById('reviewsList');
                
                if (this.filteredReviews.length === 0) {
                    reviewsList.innerHTML = this.getEmptyStateHTML();
                    return;
                }
                
                reviewsList.innerHTML = '';
                
                this.filteredReviews.forEach(review => {
                    const reviewDate = this.formatDate(review.date);
                    
                    let reviewHtml = '';
                    
                    if (review.status === 'completed') {
                        reviewHtml = `
                            <div class="review-header">
                                <div class="review-info">
                                    <div class="review-icon">
                                        <i class="fas fa-${this.getServiceIcon(review.serviceType)}"></i>
                                    </div>
                                    <div class="review-details">
                                        <h4>${review.title}</h4>
                                        <div class="review-meta">
                                            <span>Provider: ${review.provider}</span>
                                            <span>Date: ${reviewDate}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="review-rating">
                                    <div class="stars">
                                        ${this.generateStars(review.rating)}
                                    </div>
                                    <span class="rating-number">${review.rating.toFixed(1)}</span>
                                </div>
                            </div>
                            
                            <div class="review-content">
                                ${review.comment}
                            </div>
                            
                            <div class="review-details-grid">
                                <div class="detail-item">
                                    <span class="detail-label">Service Quality</span>
                                    <span class="detail-value">${review.categories.quality || 'Not rated'}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Professionalism</span>
                                    <span class="detail-value">${review.categories.professionalism || 'Not rated'}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Timeliness</span>
                                    <span class="detail-value">${review.categories.timeliness || 'Not rated'}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Value for Money</span>
                                    <span class="detail-value">${review.categories.value || 'Not rated'}</span>
                                </div>
                            </div>
                            
                            <div class="review-actions">
                                <button class="action-btn edit-review-btn" data-id="${review.id}">
                                    <i class="fas fa-edit"></i> Edit Review
                                </button>
                                <button class="action-btn share-review-btn" data-id="${review.id}">
                                    <i class="fas fa-share"></i> Share
                                </button>
                            </div>
                        `;
                    } else {
                        reviewHtml = `
                            <div class="review-header">
                                <div class="review-info">
                                    <div class="review-icon">
                                        <i class="fas fa-${this.getServiceIcon(review.serviceType)}"></i>
                                    </div>
                                    <div class="review-details">
                                        <h4>${review.title}</h4>
                                        <div class="review-meta">
                                            <span>Provider: ${review.provider}</span>
                                            <span>Date: ${reviewDate}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="pending-badge">Pending Review</div>
                            </div>
                            
                            <div class="review-content">
                                This service was completed recently. Share your experience to help other customers and the service provider improve their services.
                            </div>
                            
                            <div class="review-actions">
                                <button class="action-btn primary rate-service-btn" data-id="${review.id}">
                                    <i class="fas fa-star"></i> Rate Service
                                </button>
                            </div>
                        `;
                    }
                    
                    const reviewItem = document.createElement('div');
                    reviewItem.className = `review-item ${review.status === 'pending' ? 'pending-review' : ''}`;
                    reviewItem.dataset.id = review.id;
                    reviewItem.innerHTML = reviewHtml;
                    
                    reviewsList.appendChild(reviewItem);
                });
                
                // Add event listeners to action buttons
                this.addActionButtonListeners();
            }
            
            // Get empty state HTML
            getEmptyStateHTML() {
                return `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <h3>No reviews found</h3>
                        <p>No reviews match your current filters. Try adjusting your search criteria.</p>
                        <button class="action-btn primary" id="resetFiltersInline">
                            <i class="fas fa-redo"></i> Reset Filters
                        </button>
                    </div>
                `;
            }
            
            // Add event listeners to action buttons
            addActionButtonListeners() {
                // Rate service buttons
                document.querySelectorAll('.rate-service-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const reviewId = btn.dataset.id;
                        this.openRatingModal(reviewId);
                    });
                });
                
                // Edit review buttons
                document.querySelectorAll('.edit-review-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const reviewId = btn.dataset.id;
                        this.openRatingModal(reviewId, true);
                    });
                });
                
                // Share review buttons
                document.querySelectorAll('.share-review-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const reviewId = btn.dataset.id;
                        this.shareReview(reviewId);
                    });
                });
                
                // Reset filters inline button
                const resetFiltersInline = document.getElementById('resetFiltersInline');
                if (resetFiltersInline) {
                    resetFiltersInline.addEventListener('click', () => {
                        this.resetFilters();
                    });
                }
            }
            
            // Update review insights
            updateInsights() {
                this.updateRatingDistribution();
                this.updateServiceRatings();
            }
            
            // Update rating distribution
            updateRatingDistribution() {
                const ratingDistribution = document.getElementById('ratingDistribution');
                const completedReviews = this.reviewData.filter(r => r.status === 'completed');
                
                // Calculate rating counts
                const ratingCounts = {5: 0, 4: 0, 3: 0, 2: 0, 1: 0};
                completedReviews.forEach(review => {
                    if (review.rating >= 1 && review.rating <= 5) {
                        ratingCounts[review.rating]++;
                    }
                });
                
                // Calculate total reviews
                const totalReviews = completedReviews.length;
                
                // Generate rating distribution HTML
                let distributionHTML = '';
                for (let rating = 5; rating >= 1; rating--) {
                    const count = ratingCounts[rating];
                    const percentage = totalReviews > 0 ? (count / totalReviews) * 100 : 0;
                    
                    distributionHTML += `
                        <div class="rating-bar">
                            <span class="rating-label">${rating} Star${rating !== 1 ? 's' : ''}</span>
                            <div class="rating-progress">
                                <div class="rating-fill" style="width: ${percentage}%"></div>
                            </div>
                            <span class="rating-count">${count}</span>
                        </div>
                    `;
                }
                
                ratingDistribution.innerHTML = distributionHTML;
            }
            
            // Update service ratings
            updateServiceRatings() {
                const serviceRatings = document.getElementById('serviceRatings');
                const completedReviews = this.reviewData.filter(r => r.status === 'completed');
                
                // Calculate average ratings by service type
                const serviceRatingsMap = {};
                completedReviews.forEach(review => {
                    if (!serviceRatingsMap[review.serviceType]) {
                        serviceRatingsMap[review.serviceType] = {
                            total: 0,
                            count: 0,
                            average: 0
                        };
                    }
                    serviceRatingsMap[review.serviceType].total += review.rating;
                    serviceRatingsMap[review.serviceType].count++;
                });
                
                // Calculate averages
                Object.keys(serviceRatingsMap).forEach(serviceType => {
                    const data = serviceRatingsMap[serviceType];
                    data.average = data.count > 0 ? (data.total / data.count).toFixed(1) : 0;
                });
                
                // Generate service ratings HTML
                let serviceRatingsHTML = '';
                Object.keys(serviceRatingsMap).forEach(serviceType => {
                    const data = serviceRatingsMap[serviceType];
                    const serviceName = serviceType.charAt(0).toUpperCase() + serviceType.slice(1);
                    
                    serviceRatingsHTML += `
                        <div class="service-rating-item">
                            <span class="service-name">${serviceName}</span>
                            <div class="service-rating">
                                <span class="service-rating-stars">
                                    ${this.generateStars(Math.round(data.average))}
                                </span>
                                <span class="service-rating-value">${data.average}</span>
                            </div>
                        </div>
                    `;
                });
                
                serviceRatings.innerHTML = serviceRatingsHTML;
            }
            
            // Filter reviews based on current filters
            filterReviews() {
                const ratingFilter = document.getElementById('ratingFilter').value;
                const serviceTypeFilter = document.getElementById('serviceTypeFilter').value;
                const statusFilter = document.getElementById('statusFilter').value;
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                
                this.filteredReviews = this.reviewData;
                
                // Apply rating filter
                if (ratingFilter !== 'all') {
                    this.filteredReviews = this.filteredReviews.filter(review => review.rating === parseInt(ratingFilter));
                }
                
                // Apply service type filter
                if (serviceTypeFilter !== 'all') {
                    this.filteredReviews = this.filteredReviews.filter(review => review.serviceType === serviceTypeFilter);
                }
                
                // Apply status filter
                if (statusFilter !== 'all') {
                    this.filteredReviews = this.filteredReviews.filter(review => review.status === statusFilter);
                }
                
                // Apply search filter
                if (searchTerm) {
                    this.filteredReviews = this.filteredReviews.filter(review => 
                        review.title.toLowerCase().includes(searchTerm) ||
                        review.provider.toLowerCase().includes(searchTerm) ||
                        review.comment.toLowerCase().includes(searchTerm)
                    );
                }
                
                // Update stats
                this.updateStats();
                
                // Render filtered reviews
                this.renderReviewItems();
            }
            
            // Update stats based on filtered reviews
            updateStats() {
                const total = this.filteredReviews.length;
                const completed = this.filteredReviews.filter(r => r.status === 'completed').length;
                const pending = this.filteredReviews.filter(r => r.status === 'pending').length;
                
                // Calculate average rating
                const ratedReviews = this.filteredReviews.filter(r => r.rating > 0);
                const average = ratedReviews.length > 0 
                    ? (ratedReviews.reduce((sum, review) => sum + review.rating, 0) / ratedReviews.length).toFixed(1)
                    : 0;
                
                // Count positive reviews (4+ stars)
                const positive = ratedReviews.filter(r => r.rating >= 4).length;
                
                document.getElementById('totalReviews').textContent = total;
                document.getElementById('averageRating').textContent = average;
                document.getElementById('positiveReviews').textContent = positive;
                document.getElementById('pendingReviews').textContent = pending;
            }
            
            // Save filter preferences to localStorage
            saveFilterPreferences() {
                const filterPreferences = {
                    rating: document.getElementById('ratingFilter').value,
                    serviceType: document.getElementById('serviceTypeFilter').value,
                    status: document.getElementById('statusFilter').value,
                    search: document.getElementById('searchInput').value
                };
                
                localStorage.setItem('fixitnow_review_filters', JSON.stringify(filterPreferences));
            }
            
            // Load filter preferences from localStorage
            loadFilterPreferences() {
                const savedFilters = localStorage.getItem('fixitnow_review_filters');
                
                if (savedFilters) {
                    const filterPreferences = JSON.parse(savedFilters);
                    
                    document.getElementById('ratingFilter').value = filterPreferences.rating;
                    document.getElementById('serviceTypeFilter').value = filterPreferences.serviceType;
                    document.getElementById('statusFilter').value = filterPreferences.status;
                    document.getElementById('searchInput').value = filterPreferences.search;
                    
                    this.filterReviews();
                }
            }
            
            // Reset all filters
            resetFilters() {
                document.getElementById('ratingFilter').value = 'all';
                document.getElementById('serviceTypeFilter').value = 'all';
                document.getElementById('statusFilter').value = 'all';
                document.getElementById('searchInput').value = '';
                
                this.saveFilterPreferences();
                this.filterReviews();
                this.showToast('Filters reset successfully', 'success');
            }
            
            // Export reviews
            exportReviews() {
                this.showToast('Preparing your export...', 'info');
                
                // Simulate export process
                setTimeout(() => {
                    this.showToast('Reviews exported successfully!', 'success');
                    // In a real app, this would trigger a download
                }, 1500);
            }
            
            // Open rating modal
            openRatingModal(reviewId, isEdit = false) {
                const review = this.reviewData.find(r => r.id == reviewId);
                if (!review) return;
                
                document.getElementById('serviceTitle').value = review.title;
                document.getElementById('providerName').value = review.provider;
                
                // Set existing values if editing
                if (isEdit) {
                    document.getElementById('reviewComment').value = review.comment;
                    this.setStarRating('overallRating', review.rating);
                    
                    // Set category ratings
                    if (review.categories.quality) {
                        this.setCategoryRating('quality', this.getRatingFromText(review.categories.quality));
                    }
                    if (review.categories.professionalism) {
                        this.setCategoryRating('professionalism', this.getRatingFromText(review.categories.professionalism));
                    }
                    if (review.categories.timeliness) {
                        this.setCategoryRating('timeliness', this.getRatingFromText(review.categories.timeliness));
                    }
                    if (review.categories.value) {
                        this.setCategoryRating('value', this.getRatingFromText(review.categories.value));
                    }
                } else {
                    // Reset form for new review
                    document.getElementById('reviewComment').value = '';
                    this.setStarRating('overallRating', 0);
                    this.setCategoryRating('quality', 0);
                    this.setCategoryRating('professionalism', 0);
                    this.setCategoryRating('timeliness', 0);
                    this.setCategoryRating('value', 0);
                }
                
                // Store the review ID and edit mode
                document.getElementById('ratingModal').dataset.reviewId = reviewId;
                document.getElementById('ratingModal').dataset.isEdit = isEdit;
                
                this.openRatingModal();
            }
            
            // Open rating modal
            openRatingModal() {
                document.getElementById('ratingModal').classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            // Close rating modal
            closeRatingModal() {
                document.getElementById('ratingModal').classList.remove('active');
                document.body.style.overflow = '';
            }
            
            // Set star rating
            setStarRating(containerId, rating) {
                const container = document.getElementById(containerId);
                const stars = container.querySelectorAll('i');
                
                stars.forEach((star, index) => {
                    if (index < rating) {
                        star.className = 'fas fa-star active';
                    } else {
                        star.className = 'far fa-star';
                    }
                });
                
                container.dataset.rating = rating;
            }
            
            // Set category rating
            setCategoryRating(category, rating) {
                const container = document.querySelector(`.category-stars[data-category="${category}"]`);
                const stars = container.querySelectorAll('i');
                
                stars.forEach((star, index) => {
                    if (index < rating) {
                        star.className = 'fas fa-star active';
                    } else {
                        star.className = 'far fa-star';
                    }
                });
                
                container.dataset.rating = rating;
            }
            
            // Get rating from text description
            getRatingFromText(text) {
                const ratings = {
                    'Excellent': 5,
                    'Outstanding': 5,
                    'Very Good': 4,
                    'Professional': 4,
                    'Good': 3,
                    'Fair': 3,
                    'Slightly Late': 3,
                    'On Time': 5,
                    'Early': 5,
                    'Great Value': 5,
                    'Excellent Value': 5,
                    'Fair Price': 4,
                    'Good Value': 3
                };
                return ratings[text] || 0;
            }
            
            // Get text from rating
            getTextFromRating(category, rating) {
                const texts = {
                    quality: ['Poor', 'Fair', 'Good', 'Very Good', 'Excellent'],
                    professionalism: ['Unprofessional', 'Fair', 'Good', 'Professional', 'Outstanding'],
                    timeliness: ['Very Late', 'Late', 'Slightly Late', 'On Time', 'Early'],
                    value: ['Poor Value', 'Fair Value', 'Good Value', 'Great Value', 'Excellent Value']
                };
                return texts[category] ? texts[category][rating - 1] : '';
            }
            
            // Submit review
            submitReview() {
                const modal = document.getElementById('ratingModal');
                const reviewId = modal.dataset.reviewId;
                const isEdit = modal.dataset.isEdit === 'true';
                
                const review = this.reviewData.find(r => r.id == reviewId);
                if (!review) return;
                
                const overallRating = parseInt(document.getElementById('overallRating').dataset.rating) || 0;
                const comment = document.getElementById('reviewComment').value;
                
                if (overallRating === 0) {
                    this.showToast('Please provide an overall rating before submitting.', 'error');
                    return;
                }
                
                if (!comment.trim()) {
                    this.showToast('Please provide a review comment before submitting.', 'error');
                    return;
                }
                
                const submitBtn = document.getElementById('submitReviewBtn');
                const originalText = submitBtn.innerHTML;
                
                // Show loading state
                submitBtn.innerHTML = '<div class="loading"></div> Submitting...';
                submitBtn.disabled = true;
                
                // Simulate API call
                setTimeout(() => {
                    // Update review data
                    review.rating = overallRating;
                    review.comment = comment;
                    review.status = 'completed';
                    
                    // Update category ratings
                    review.categories.quality = this.getTextFromRating('quality', parseInt(document.querySelector('.category-stars[data-category="quality"]').dataset.rating) || 0);
                    review.categories.professionalism = this.getTextFromRating('professionalism', parseInt(document.querySelector('.category-stars[data-category="professionalism"]').dataset.rating) || 0);
                    review.categories.timeliness = this.getTextFromRating('timeliness', parseInt(document.querySelector('.category-stars[data-category="timeliness"]').dataset.rating) || 0);
                    review.categories.value = this.getTextFromRating('value', parseInt(document.querySelector('.category-stars[data-category="value"]').dataset.rating) || 0);
                    
                    // Close modal
                    this.closeRatingModal();
                    
                    // Update UI
                    this.filterReviews();
                    this.updateInsights();
                    
                    // Show success message
                    this.showToast(isEdit ? 'Review updated successfully!' : 'Review submitted successfully!', 'success');
                    
                    // Reset button
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }, 1500);
            }
            
            // Share review
            shareReview(reviewId) {
                const review = this.reviewData.find(r => r.id == reviewId);
                if (!review) return;
                
                this.showToast(`Sharing review for ${review.title}...`, 'info');
                // In a real app, this would open a share dialog
            }
            
            // Search functionality
            performSearch(query) {
                const searchResults = document.getElementById('searchResults');
                
                if (query.trim() === '') {
                    searchResults.classList.remove('active');
                    return;
                }
                
                const searchData = [
                    { title: "Plumbing Services", desc: "Leak repairs, pipe installation, drain cleaning", type: "service", link: "#" },
                    { title: "Electrical Services", desc: "Wiring, fixtures, circuit repairs", type: "service", link: "#" },
                    { title: "Painting Services", desc: "Interior and exterior painting", type: "service", link: "#" },
                    { title: "Carpentry Services", desc: "Furniture, cabinets, woodwork", type: "service", link: "#" },
                    { title: "Mike Plumbing Pros", desc: "Certified plumber with 15+ years experience", type: "provider", link: "#" },
                    { title: "Electro Masters", desc: "Licensed electricians for all your needs", type: "provider", link: "#" },
                    { title: "Color Masters", desc: "Professional painting services", type: "provider", link: "#" },
                    { title: "Woodcraft Masters", desc: "Custom carpentry and woodworking", type: "provider", link: "#" }
                ];
                
                const filteredResults = searchData.filter(item => 
                    item.title.toLowerCase().includes(query.toLowerCase()) || 
                    item.desc.toLowerCase().includes(query.toLowerCase())
                );
                
                this.displaySearchResults(filteredResults);
            }
            
            displaySearchResults(results) {
                const searchResults = document.getElementById('searchResults');
                searchResults.innerHTML = '';
                
                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="search-result-item">No results found</div>';
                } else {
                    results.forEach(result => {
                        const resultItem = document.createElement('div');
                        resultItem.className = 'search-result-item';
                        resultItem.innerHTML = `
                            <div class="search-result-title">${result.title}</div>
                            <div class="search-result-desc">${result.desc}</div>
                        `;
                        resultItem.addEventListener('click', () => {
                            // In a real app, this would navigate to the result page
                            this.showToast(`You selected: ${result.title}`, 'success');
                            document.getElementById('searchInput').value = '';
                            searchResults.classList.remove('active');
                        });
                        searchResults.appendChild(resultItem);
                    });
                }
                
                searchResults.classList.add('active');
            }
            
            // Notifications functionality
            updateNotifications() {
                const notificationsList = document.getElementById('notificationsList');
                const notificationBadge = document.getElementById('notificationBadge');
                
                if (!notificationsList) return;
                
                const notifications = [
                    { 
                        id: 1, 
                        title: "Review Request", 
                        desc: "Please rate your recent service with Color Masters", 
                        time: "2 days ago", 
                        icon: "fas fa-star",
                        read: false 
                    },
                    { 
                        id: 2, 
                        title: "New Review Response", 
                        desc: "Mike Plumbing Pros responded to your review", 
                        time: "1 week ago", 
                        icon: "fas fa-comment",
                        read: false 
                    },
                    { 
                        id: 3, 
                        title: "Review Published", 
                        desc: "Your review for Electro Masters has been published", 
                        time: "2 weeks ago", 
                        icon: "fas fa-check-circle",
                        read: true 
                    }
                ];
                
                notificationsList.innerHTML = '';
                
                const unreadCount = notifications.filter(n => !n.read).length;
                if (notificationBadge) notificationBadge.textContent = unreadCount;
                
                if (notifications.length === 0) {
                    notificationsList.innerHTML = '<div class="no-notifications">No notifications</div>';
                    return;
                }
                
                notifications.forEach(notification => {
                    const notificationItem = document.createElement('div');
                    notificationItem.className = `notification-item ${notification.read ? '' : 'unread'}`;
                    notificationItem.innerHTML = `
                        <div class="notification-icon-small">
                            <i class="${notification.icon}"></i>
                        </div>
                        <div class="notification-content">
                            <div class="notification-title">${notification.title}</div>
                            <div class="notification-desc">${notification.desc}</div>
                            <div class="notification-time">${notification.time}</div>
                        </div>
                    `;
                    notificationItem.addEventListener('click', () => {
                        this.showToast(`Notification: ${notification.title}`, 'success');
                        document.getElementById('notificationsPanel').classList.remove('active');
                    });
                    notificationsList.appendChild(notificationItem);
                });
            }
            
            // Show toast notification
            showToast(message, type = 'info') {
                const toastContainer = document.getElementById('toastContainer');
                const toastId = 'toast-' + Date.now();
                
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.id = toastId;
                toast.innerHTML = `
                    <div class="toast-icon">
                        <i class="fas fa-${this.getToastIcon(type)}"></i>
                    </div>
                    <div class="toast-content">
                        <div class="toast-title">${this.getToastTitle(type)}</div>
                        <div class="toast-message">${message}</div>
                    </div>
                    <button class="toast-close">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                toastContainer.appendChild(toast);
                
                // Show toast with animation
                setTimeout(() => {
                    toast.classList.add('show');
                }, 10);
                
                // Close button
                toast.querySelector('.toast-close').addEventListener('click', () => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                });
                
                return toastId;
            }
            
            // Get toast icon based on type
            getToastIcon(type) {
                const icons = {
                    'success': 'check-circle',
                    'error': 'exclamation-circle',
                    'warning': 'exclamation-triangle',
                    'info': 'info-circle'
                };
                return icons[type] || 'info-circle';
            }
            
            // Get toast title based on type
            getToastTitle(type) {
                const titles = {
                    'success': 'Success',
                    'error': 'Error',
                    'warning': 'Warning',
                    'info': 'Information'
                };
                return titles[type] || 'Information';
            }
        }

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.reviewsApp = new ReviewsApp();
        });
    </script>
</body>
</html>